<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fluentigo ‚Äî —è–∑—ã–∫</title>
  <link rel="stylesheet" href="./styles.css" />
</head>

<body>
  <header class="topbar">
    <div class="container topbar-row">
      <a class="brand" href="./index.html" aria-label="Fluentigo">
        <span class="brand-dot"></span>
        <span class="brand-name" id="siteName">Fluentigo</span>
      </a>

      <nav class="nav" aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è">
        <a href="./index.html#languages" data-i18n="nav_languages">–Ø–∑—ã–∫–∏</a>
        <a href="./index.html#about" data-i18n="nav_about">–ö—Ç–æ –º—ã?</a>
        <a href="./index.html#pricing" data-i18n="nav_pricing">–†–∞—Å—Ü–µ–Ω–∫–∏</a>
        <a href="./index.html#contact" data-i18n="nav_contact">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
      </nav>
      <div class="ui-switch" aria-label="–í—ã–±–æ—Ä —è–∑—ã–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞">
        <button class="ui-pill" id="uiRu" type="button" aria-pressed="true" title="–†—É—Å—Å–∫–∏–π">
          <span class="flag-mini"><img src="./assets/flags/ru.svg" alt="RU"></span><span>RU</span>
        </button>
        <button class="ui-pill" id="uiUa" type="button" aria-pressed="false" title="–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞">
          <span class="flag-mini"><img src="./assets/flags/ua.svg" alt="UA"></span><span>UA</span>
        </button>
      </div>
    </div>
  </header>

  <main class="section">
    <div class="container">
      <div class="panel lang-header">
        <div class="lang-title">
          <div class="lang-flag big" id="langFlag">üè≥Ô∏è</div>
          <div>
            <h1 class="lang-h1" id="langName">–Ø–∑—ã–∫</h1>
            <p class="muted" id="langSubtitle"></p>
          </div>
        </div>
        <a class="btn btn-ghost" href="./index.html#languages">‚Üê –ù–∞–∑–∞–¥</a>
      </div>

      <div class="panel">
        <h2>–î–ª—è —á–µ–≥–æ –≤–∞–º —è–∑—ã–∫?</h2>
        <div class="goal-grid" id="goalGrid"></div>
      </div>
    
      <div class="panel">
        <h2 data-i18n="level_title">–ö–∞–∫–æ–π —É—Ä–æ–≤–µ–Ω—å —Ö–æ—Ç–∏—Ç–µ?</h2>
        <p class="muted" data-i18n="level_subtitle">–í—ã–±–µ—Ä–∏—Ç–µ —Ü–µ–ª–µ–≤–æ–π —É—Ä–æ–≤–µ–Ω—å. B2‚ÄìC1 ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∞.</p>
        <div class="level-grid" id="levelGrid"></div>
      </div>

      <div class="panel" id="readyPanel" style="display:none;">
        <div class="teachers-head" style="align-items:center;">
          <h2 style="margin:0;" data-i18n="ready_title">–ì–æ—Ç–æ–≤–æ</h2>
          <button class="btn" id="showTeachersBtn" type="button" data-i18n="ready_btn">–ü–æ–∫–∞–∑–∞—Ç—å —É—á–∏—Ç–µ–ª–µ–π</button>
        </div>
        <p class="muted tiny" id="readyText"></p>
      </div>
</div>
  </main>

  <footer class="footer">
    <div class="container footer-row">
      <div>
        <div class="muted" id="footerText"></div>
        <div class="footer-contacts" id="footerContacts"></div>
      </div>
      <span class="muted tiny">Fluentigo ‚Äî Language School</span>
    </div>
  </footer>

  <script>
    const $ = (id) => document.getElementById(id);

    
    const ICONS = {
      whatsapp: `<svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M20 12a8 8 0 1 1-2.3-5.7A8 8 0 0 1 20 12Z" stroke="currentColor" stroke-width="2"/><path d="M8 20l1-3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M9.5 9.5c.4 2.2 2.8 4.6 5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>`,
      telegram: `<svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 4 3.7 10.7c-.9.4-.9 1.1-.2 1.3l4.5 1.4 1.7 5.2c.2.6.3.6.7.2l2.6-2.5 5 3.7c.9.5 1.5.2 1.7-.8L22 5.3c.2-1.1-.5-1.7-1-1.3Z" fill="currentColor"/></svg>`,
      instagram: `<svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true"><rect x="4" y="4" width="16" height="16" rx="5" stroke="currentColor" stroke-width="2"/><path d="M8 12a4 4 0 1 0 8 0 4 4 0 0 0-8 0Z" stroke="currentColor" stroke-width="2"/><path d="M17.5 6.6h.01" stroke="currentColor" stroke-width="3" stroke-linecap="round"/></svg>`,
      facebook: `<svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M14 9h3V6h-3c-2.2 0-4 1.8-4 4v3H7v3h3v6h3v-6h3l1-3h-4v-3c0-.6.4-1 1-1Z" fill="currentColor"/></svg>`,
      email: `<svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 6h16v12H4V6Z" stroke="currentColor" stroke-width="2" /><path d="M4 7l8 6 8-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>`
    };

    function inferIconKey(link){
      const label = (link.label || '').toLowerCase();
      const url = (link.url || '').toLowerCase();
      if (url.startsWith('mailto:') || label.includes('email')) return 'email';
      if (label.includes('whatsapp')) return 'whatsapp';
      if (label.includes('telegram')) return 'telegram';
      if (label.includes('instagram')) return 'instagram';
      if (label.includes('facebook')) return 'facebook';
      return 'email';
    }
    function makeSocialIcon(link, isFooter=false){
      const key = inferIconKey(link);
      const a = el('a', {
        class: isFooter ? 'footer-link social-icon' : 'social-icon',
        href: link.url,
        target: '_blank',
        rel: 'noopener',
        title: link.label
      });
      a.innerHTML = ICONS[key] + `<span>${link.label}</span>`;
      return a;
    }

    function qp(name){ return new URL(location.href).searchParams.get(name); }
    function getUI(){ return qp('ui') || localStorage.getItem('ui') || 'ru'; }
    function setUI(ui){
      localStorage.setItem('ui', ui);
      $('uiRu').setAttribute('aria-pressed', ui==='ru' ? 'true':'false');
      $('uiUa').setAttribute('aria-pressed', ui==='ua' ? 'true':'false');
      document.documentElement.lang = ui==='ua' ? 'uk' : 'ru';
      const I = {
        ru:{nav_languages:'–Ø–∑—ã–∫–∏',nav_about:'–ö—Ç–æ –º—ã?',nav_pricing:'–†–∞—Å—Ü–µ–Ω–∫–∏',nav_contact:'–ö–æ–Ω—Ç–∞–∫—Ç—ã',
            level_title:'–ö–∞–∫–æ–π —É—Ä–æ–≤–µ–Ω—å —Ö–æ—Ç–∏—Ç–µ?',level_subtitle:'–í—ã–±–µ—Ä–∏—Ç–µ —Ü–µ–ª–µ–≤–æ–π —É—Ä–æ–≤–µ–Ω—å. B2‚ÄìC1 ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∞.',
            ready_title:'–ì–æ—Ç–æ–≤–æ',ready_btn:'–ü–æ–∫–∞–∑–∞—Ç—å —É—á–∏—Ç–µ–ª–µ–π'},
        ua:{nav_languages:'–ú–æ–≤–∏',nav_about:'–•—Ç–æ –º–∏?',nav_pricing:'–¶—ñ–Ω–∏',nav_contact:'–ö–æ–Ω—Ç–∞–∫—Ç–∏',
            level_title:'–Ø–∫–∏–π —Ä—ñ–≤–µ–Ω—å —Ö–æ—á–µ—Ç–µ?',level_subtitle:'–û–±–µ—Ä—ñ—Ç—å —Ü—ñ–ª—å–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å. B2‚ÄìC1 ‚Äî –æ–∫—Ä–µ–º–∞ –≥—Ä—É–ø–∞.',
            ready_title:'–ì–æ—Ç–æ–≤–æ',ready_btn:'–ü–æ–∫–∞–∑–∞—Ç–∏ –≤—á–∏—Ç–µ–ª—ñ–≤'}
      };
      document.querySelectorAll('[data-i18n]').forEach(n=>{
        const k=n.getAttribute('data-i18n');
        if(I[ui] && I[ui][k]) n.textContent = I[ui][k];
      });
    }
function el(tag, attrs = {}, children = []) {
      const n = document.createElement(tag);
      for (const [k, v] of Object.entries(attrs)) {
        if (k === 'class') n.className = v;
        else n.setAttribute(k, v);
      }
      for (const c of children) n.appendChild(typeof c === 'string' ? document.createTextNode(c) : c);
      return n;
    }

    function applyTheme(theme) {
      const r = document.documentElement;
      r.style.setProperty('--page-bg', theme.pageBg);
      r.style.setProperty('--text', theme.text);
      r.style.setProperty('--panel-bg', theme.panelBg);
      r.style.setProperty('--topbar-bg', theme.topbarBg);
      r.style.setProperty('--topbar-text', theme.topbarText);
    }

    
    // --- i18n helper: supports both plain strings and {ru,ua} objects in data.json
    function pick(v, ui=getUI()){
      if (v == null) return '';
      if (typeof v === 'string' || typeof v === 'number' || typeof v === 'boolean') return String(v);
      if (Array.isArray(v)) return v.map(x => pick(x, ui));
      if (typeof v === 'object') return (v[ui] ?? v.ua ?? v.uk ?? v.ru ?? '');
      return String(v);
    }

function renderFooter(data) {
      $('footerText').textContent = pick(data.site.footerText);
      const fc = $('footerContacts');
      fc.innerHTML = '';
      (data.contact.items || []).forEach(i => {
        fc.appendChild(el('span', { class: 'footer-link' }, [`${pick(i.label)}: ${i.value}`]));
      });
      (data.contact.links || []).forEach(l => { fc.appendChild(makeSocialIcon(l, true)); });
    }

    function qp(name){ return new URL(location.href).searchParams.get(name); }

    (async function init(){
      const res = await fetch('./data.json', { cache: 'no-store' });
      const data = await res.json();
      setUI(getUI());
      $('uiRu').addEventListener('click', ()=>{ location.search = `?lang=${encodeURIComponent(qp('lang')||'')}&ui=ru`; });
      $('uiUa').addEventListener('click', ()=>{ location.search = `?lang=${encodeURIComponent(qp('lang')||'')}&ui=ua`; });
      $('siteName').textContent = data.site.name;
      renderFooter(data);

      const langId = qp('lang');
      const lang = data.languages.find(x => x.id === langId);
      if (!lang) {
        applyTheme(data.site.defaultTheme);
        $('langName').textContent = '–Ø–∑—ã–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω';
        $('langSubtitle').textContent = '–í–µ—Ä–Ω–∏—Ç–µ—Å—å –Ω–∞ –≥–ª–∞–≤–Ω—É—é –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫.';
        return;
      }

      applyTheme(lang.theme);
      document.title = `${data.site.name} ‚Äî ${pick(lang.name)}`;

      (function(){
        const lf = $('langFlag');
        lf.innerHTML = '';
        if (typeof lang.flag === 'string' && (lang.flag.endsWith('.svg') || lang.flag.endsWith('.png') || lang.flag.endsWith('.jpg') || lang.flag.endsWith('.webp'))){
          lf.appendChild(el('img', { class:'flag-img', src: lang.flag, alt: pick(lang.name) }));
        } else {
          lf.textContent = lang.flag || '';
        }
      })();
      $('langName').textContent = pick(lang.name);
      $('langSubtitle').textContent = (getUI()==='ua' ? '–û–±–µ—Ä—ñ—Ç—å —Ü—ñ–ª—å —ñ —Ä—ñ–≤–µ–Ω—å ‚Äî –ø–æ–∫–∞–∂–µ–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏—Ö –≤–∏–∫–ª–∞–¥–∞—á—ñ–≤.' : '–í—ã–±–µ—Ä–∏—Ç–µ —Ü–µ–ª—å –∏ —É—Ä–æ–≤–µ–Ω—å ‚Äî –ø–æ–∫–∞–∂–µ–º –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π.');

      const grid = $('goalGrid');
      grid.innerHTML = '';
      let selectedGoal = qp('goal') || null;
      let selectedLevel = qp('level') || null;

      function updateReady(){
        const rp = document.getElementById('readyPanel');
        const btn = document.getElementById('showTeachersBtn');
        if (selectedGoal && selectedLevel){
          rp.style.display = '';
          const goalObj = (lang.goals||[]).find(x=>x.id===selectedGoal);
          document.getElementById('readyText').textContent = `${goalObj?pick(goalObj.title):'–¶–µ–ª—å'} + ${selectedLevel}`;
          btn.disabled = false;
        } else {
          rp.style.display = 'none';
        }
      }

      // goals selectable
      grid.innerHTML = '';
      (lang.goals||[]).forEach(g=>{
        const b = el('button', { class:'goal-card', type:'button', 'aria-pressed': (selectedGoal===g.id ? 'true':'false') }, [
          el('div', { class:'goal-title' }, [pick(g.title)]),
          el('div', { class:'muted' }, [pick(g.subtitle)])
        ]);
        b.addEventListener('click', ()=>{
          selectedGoal = g.id;
          [...grid.querySelectorAll('.goal-card')].forEach(x=>x.setAttribute('aria-pressed','false'));
          b.setAttribute('aria-pressed','true');
          updateReady();
        });
        grid.appendChild(b);
      });

      // levels
      const levels = ['A1','A2','B1','B2','C1'];
      const lg = document.getElementById('levelGrid');
      lg.innerHTML='';
      levels.forEach((lv, i)=>{
        if (lv==='B2') lg.appendChild(el('span',{class:'level-sep'},[]));
        const b = el('button', {class:'level-btn', type:'button', 'aria-pressed': (selectedLevel===lv ? 'true':'false')}, [lv]);
        b.addEventListener('click', ()=>{
          selectedLevel = lv;
          [...lg.querySelectorAll('.level-btn')].forEach(x=>x.setAttribute('aria-pressed','false'));
          b.setAttribute('aria-pressed','true');
          updateReady();
        });
        lg.appendChild(b);
      });

      document.getElementById('showTeachersBtn').addEventListener('click', ()=>{
        if (!selectedGoal || !selectedLevel) return;
        const ui = getUI();
        location.href = `./teachers.html?lang=${encodeURIComponent(lang.id)}&goal=${encodeURIComponent(selectedGoal)}&level=${encodeURIComponent(selectedLevel)}&ui=${encodeURIComponent(ui)}`;
      });

      updateReady();
    })().catch(console.error);
  </script>
</body>
</html>
